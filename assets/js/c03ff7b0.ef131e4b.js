"use strict";(self.webpackChunkrelational_migrator_lab=self.webpackChunkrelational_migrator_lab||[]).push([["3770"],{4446:function(e,o,n){n.r(o),n.d(o,{default:()=>u,frontMatter:()=>r,metadata:()=>t,assets:()=>d,toc:()=>c,contentTitle:()=>l});var t=JSON.parse('{"id":"edit-mapping-rules/add-mapping-books-authors","title":"\uD83D\uDC50 Add authors details to the books collection","description":"\uD83D\uDC50 Add author name to the books collection","source":"@site/docs/80-edit-mapping-rules/30-add-mapping-books-authors.mdx","sourceDirName":"80-edit-mapping-rules","slug":"/edit-mapping-rules/add-mapping-books-authors","permalink":"/relational-migrator-lab/docs/edit-mapping-rules/add-mapping-books-authors","draft":false,"unlisted":false,"editUrl":"https://github.com/mongodb-developer/relational-migrator-lab/blob/main/docs/80-edit-mapping-rules/30-add-mapping-books-authors.mdx","tags":[],"version":"current","sidebarPosition":30,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\uD83D\uDC50 Change genres in books","permalink":"/relational-migrator-lab/docs/edit-mapping-rules/edit-mapping-books-book-genre"},"next":{"title":"\uD83D\uDC50 Add last three reviews to each book (from reviews table)","permalink":"/relational-migrator-lab/docs/edit-mapping-rules/add-mapping-books-reviews"}}'),s=n("5893"),i=n("65"),a=n("600");let r={},l="\uD83D\uDC50 Add authors details to the books collection",d={},c=[{value:"\uD83D\uDC50 Add author name to the books collection",id:"-add-author-name-to-the-books-collection",level:2},{value:"\uD83D\uDC50 Remove unneeded bookId from author details in books collection",id:"-remove-unneeded-bookid-from-author-details-in-books-collection",level:2}];function h(e){let o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.header,{children:(0,s.jsx)(o.h1,{id:"-add-authors-details-to-the-books-collection",children:"\uD83D\uDC50 Add authors details to the books collection"})}),"\n",(0,s.jsx)(o.h2,{id:"-add-author-name-to-the-books-collection",children:"\uD83D\uDC50 Add author name to the books collection"}),"\n",(0,s.jsxs)(o.p,{children:["We want to modify the MongoDB schema so that each book contains an array of its authors. Right now in the ",(0,s.jsx)(o.code,{children:"authorBooks"})," mapping we're getting the ",(0,s.jsx)(o.code,{children:"authorId"})," for the current book, but we want also the name of the author. So in this step we will embed the author name into array created from the mapping of the join table (which right now only contains ",(0,s.jsx)(o.code,{children:"authorId"})," and ",(0,s.jsx)(o.code,{children:"bookId"}),")"]}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["On the MongoDB diagram view, click the ",(0,s.jsx)(o.code,{children:"books"})," collection"]}),"\n",(0,s.jsxs)(o.li,{children:["On the relational mappings list on the right, click ",(0,s.jsx)(o.code,{children:"+ Add"})]}),"\n",(0,s.jsxs)(o.li,{children:["Select ",(0,s.jsx)(o.code,{children:"Embedded documents"})]}),"\n",(0,s.jsxs)(o.li,{children:["Select ",(0,s.jsx)(o.code,{children:"authors"})," as Source table"]}),"\n",(0,s.jsx)(o.li,{children:"In the advanced settings, check 'Merge fields into parent`"}),"\n",(0,s.jsxs)(o.li,{children:["Check the ",(0,s.jsx)(o.code,{children:"name"})," field and uncheck the rest"]}),"\n",(0,s.jsxs)(o.li,{children:["Click ",(0,s.jsx)(o.code,{children:"Save and close"})]}),"\n"]}),"\n",(0,s.jsx)(a.Z,{url:"http://127.0.0.1:8278",src:"img/130-image-001.png",alt:"Changes in the books collection"}),"\n",(0,s.jsx)(o.h2,{id:"-remove-unneeded-bookid-from-author-details-in-books-collection",children:"\uD83D\uDC50 Remove unneeded bookId from author details in books collection"}),"\n",(0,s.jsx)(o.p,{children:"We want to modify the MongoDB schema so that each book contains an array of its authors.\nIn this step we will remove the redundant ID fields from the join table."}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["On the MongoDB diagram view, click the ",(0,s.jsx)(o.code,{children:"books"})," collection."]}),"\n",(0,s.jsxs)(o.li,{children:["On the relational mappings list on the right, click on the edit icon of ",(0,s.jsx)(o.code,{children:"author_book"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Edit the field name from ",(0,s.jsx)(o.code,{children:"authorBooks"})," to just ",(0,s.jsx)(o.code,{children:"authors"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["In the list of fields, uncheck ",(0,s.jsx)(o.code,{children:"bookId"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["Click ",(0,s.jsx)(o.code,{children:"Save and close"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["This results in our ",(0,s.jsx)(o.code,{children:"authors"})," array looking like:"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-json",children:'    "authors": [\n        {\n            "authorId": 8282,\n            "name": "Cervantes"\n        },\n        ...\n    ]\n'})}),"\n",(0,s.jsx)(a.Z,{url:"http://127.0.0.1:8278",src:"img/140-image-001.png",alt:"Changes in the books collection"}),"\n",(0,s.jsx)(o.admonition,{type:"info",children:(0,s.jsxs)(o.p,{children:["This is a perfect example of the ",(0,s.jsx)(o.a,{href:"https://www.mongodb.com/blog/post/building-with-patterns-the-extended-reference-pattern",children:"Extended Reference Pattern"}),". When we read a book, we have some of the author's data (",(0,s.jsx)(o.code,{children:"name"})," in this case) but we still have the author's id in case we need all the author's attributes (we can then do a join on read using ",(0,s.jsx)(o.a,{href:"https://www.mongodb.com/docs/manual/reference/operator/aggregation/lookup/",children:(0,s.jsx)(o.code,{children:"$lookup"})}),")"]})})]})}function u(e={}){let{wrapper:o}={...(0,i.a)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},600:function(e,o,n){n.d(o,{Z:()=>a});var t=n("5893");function s(e){let o=e.url||"http://localhost:3000";return(0,t.jsxs)("div",{className:"browser container",children:[(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"column left",children:[(0,t.jsx)("span",{className:"dot",style:{background:"#ED594A"}}),(0,t.jsx)("span",{className:"dot",style:{background:"#FDD800"}}),(0,t.jsx)("span",{className:"dot",style:{background:"#5AC05A"}})]}),(0,t.jsx)("div",{className:"column middle",children:(0,t.jsx)("input",{type:"text",value:o})}),(0,t.jsx)("div",{className:"column right",children:(0,t.jsxs)("div",{style:{float:"right"},children:[(0,t.jsx)("span",{className:"bar"}),(0,t.jsx)("span",{className:"bar"}),(0,t.jsx)("span",{className:"bar"})]})})]}),(0,t.jsx)("div",{className:"content",children:e.children})]})}n("7294");var i=n("3187");function a(e){return(0,t.jsx)(s,{...e,children:(0,t.jsx)("img",{src:(0,i.ZP)(e.src),alt:e.alt})})}},65:function(e,o,n){n.d(o,{Z:function(){return r},a:function(){return a}});var t=n(7294);let s={},i=t.createContext(s);function a(e){let o=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:o},e.children)}}}]);