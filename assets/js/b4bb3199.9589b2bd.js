"use strict";(self.webpackChunkrelational_migrator_lab=self.webpackChunkrelational_migrator_lab||[]).push([["6742"],{2608:function(e,t,n){n.r(t),n.d(t,{default:()=>g,frontMatter:()=>c,metadata:()=>o,assets:()=>u,toc:()=>h,contentTitle:()=>d});var o=JSON.parse('{"id":"Migrate Data/monitor-cdc-migration","title":"\uD83E\uDDB8 Monitor a Continuous Migration Job","description":"When a continuous migration job has completed its initial synchronization stage, it enters the Change-Data-Capture (CDC) stage.","source":"@site/docs/220-Migrate Data/40-monitor-cdc-migration.mdx","sourceDirName":"220-Migrate Data","slug":"/Migrate Data/monitor-cdc-migration","permalink":"/relational-migrator-lab/docs/Migrate Data/monitor-cdc-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/mongodb-developer/relational-migrator-lab/blob/main/docs/220-Migrate Data/40-monitor-cdc-migration.mdx","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\uD83E\uDDB8 Run a Continuous Migration Job","permalink":"/relational-migrator-lab/docs/Migrate Data/cdc-migration"},"next":{"title":"\uD83E\uDDB8 Migration using CDC and Kafka","permalink":"/relational-migrator-lab/docs/Migrate Data/kafka-migration"}}'),r=n("5893"),a=n("65"),i=n("600"),s=n("8168"),l=n("7645");let c={},d="\uD83E\uDDB8 Monitor a Continuous Migration Job",u={},h=[];function m(e){let t={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"-monitor-a-continuous-migration-job",children:"\uD83E\uDDB8 Monitor a Continuous Migration Job"})}),"\n",(0,r.jsx)(t.p,{children:"When a continuous migration job has completed its initial synchronization stage, it enters the Change-Data-Capture (CDC) stage.\nIn this stage, the source database is monitored for changes, and these changes are applied to the target MongoDB database."}),"\n",(0,r.jsx)(i.Z,{url:"http://127.0.0.1:8278",src:"img/220-image-012.png",alt:"Screenshot of the Data Migration monitoring page"}),"\n",(0,r.jsx)(t.p,{children:"To verify changes are being captured correctly, you can make changes to the Postgres library database and check MongoDB for corresponding changes."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Using pgAdmin or psql, apply the following updates to the library database in Postgres"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"GRANT USAGE ON SCHEMA library to replication_group;\n\nINSERT INTO library.authors VALUES (9999, 'Julian May', 'julianmay', 'Born in 1931, Julian May sold her first short story to John W. Campbell''s Astounding Science Fiction magazine in 1951. It was a science fiction short story called Dune Roller. But it wasn''t until the 1980s that the author returned to genre fiction, after writing a variety of non-fiction and children''s books, often under pseudonyms. May then wrote the phenomenally successful Saga of the Exiles, followed by the Galactic Milieu series. The Many-Coloured Land, book one of the Saga of the Exiles, won the Locus Best Novel Award. It was also shortlisted for top genre awards including the Hugo, the Nebula, the Prometheus Award and the Mythopoetic Fantasy Award for Adult Literature. Julian May passed away in October 2017.', NULL);\n\nINSERT INTO library.books VALUES ('1447224051', 'Jack the Bodiless', 398, 1991, 'His powers may be the ultimate hope, if they allow him to live.', '', 2, 2, 'Jack the Bodiless', NULL, NULL, 132, 19, 1);\nINSERT INTO library.books VALUES ('144722406X', 'Diamond Mask', 402, 1994, 'She concealed her great gifts, but some plans were made to be broken.', '', 2, 2, 'Diamond Mask', NULL, NULL, 132, 19, 1);\nINSERT INTO library.books VALUES ('1447224078', 'Magnificat', 434, 1996, 'A glorious future is in sight, until the rebellion brings Armageddon.', '', 2, 2, 'Magnificat', NULL, NULL, 132, 19, 1);\n\nINSERT INTO library.book_genre VALUES ('1447224051', 803);\nINSERT INTO library.book_genre VALUES ('144722406X', 803);\nINSERT INTO library.book_genre VALUES ('1447224078', 803);\n\nINSERT INTO library.author_book VALUES (9999, '1447224051');\nINSERT INTO library.author_book VALUES (9999, '144722406X');\nINSERT INTO library.author_book VALUES (9999, '1447224078');\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["If you need to install pgAdmin, it can be downloaded from ",(0,r.jsx)(t.a,{href:"https://www.pgadmin.org/download/",children:"here"})]})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["If you are taking part in an instructor led lab, you should prefix the book IDs ",(0,r.jsx)(t.code,{children:"1447224051"}),", ",(0,r.jsx)(t.code,{children:"144722406X"}),", and ",(0,r.jsx)(t.code,{children:"1447224078"})," with a unique combination of characters (try your initials), and add a random value to the author ID ",(0,r.jsx)(t.code,{children:"9999"}),", to avoid duplicate key errors with your classmates."]})}),"\n",(0,r.jsxs)(t.p,{children:["If continuous migration is operating correctly, you should see an update to the ",(0,r.jsx)(t.code,{children:"Total events seen"})," and ",(0,r.jsx)(t.code,{children:"Events in the last hour"})," counts in Relational Migrator."]}),"\n",(0,r.jsx)(i.Z,{url:"http://127.0.0.1:8278",src:"img/220-image-013.png",alt:"Screenshot of the Data Migration monitoring page"}),"\n",(0,r.jsx)(t.p,{children:"Now check for the new books in MongoDB:"}),"\n",(0,r.jsxs)(s.Z,{groupId:"MongoDB Interfaces Documents Added",children:[(0,r.jsxs)(l.Z,{value:"Atlas UI",label:"Atlas UI",children:[(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["In a web browser, navigate to the ",(0,r.jsx)(t.a,{href:"https://cloud.mongodb.com",children:"MongoDB Atlas portal"})," and sign in with your account"]}),"\n",(0,r.jsx)(t.li,{children:"Navigate to the cloud project containing the cluster you migrated data to"}),"\n",(0,r.jsxs)(t.li,{children:["Select your cluster and click ",(0,r.jsx)(t.code,{children:"View collections"})]}),"\n",(0,r.jsxs)(t.li,{children:["Select the ",(0,r.jsx)(t.code,{children:"books"})," collection in the database you migrated data to"]}),"\n",(0,r.jsxs)(t.li,{children:["Enter a query in the Filter text box that uses a regular expression to look for any book where the _id value starts with the common prefix of the books we added: ",(0,r.jsx)(t.code,{children:"{_id: /^14472240/}"})]}),"\n",(0,r.jsxs)(t.li,{children:["Click ",(0,r.jsx)(t.code,{children:"Apply"})]}),"\n",(0,r.jsx)(t.li,{children:"If the CDC process worked correctly, you should see three book documents being returned"}),"\n"]}),(0,r.jsx)(i.Z,{url:"http://cloud.mongodb.com",src:"/img/220-image-016.png",alt:"Screenshot of the Atlas UI"})]}),(0,r.jsxs)(l.Z,{value:"Compass",label:"Compass",children:[(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["In Compass, select the ",(0,r.jsx)(t.code,{children:"books"})," collection in the ",(0,r.jsx)(t.code,{children:"CONNECTIONS"})," navigation panel on the left hand side."]}),"\n",(0,r.jsxs)(t.li,{children:["Enter a query that uses a regular expression to look for any book where the _id value starts with the common prefix of the books we added: ",(0,r.jsx)(t.code,{children:"{_id: /^14472240/}"})]}),"\n",(0,r.jsxs)(t.li,{children:["Click ",(0,r.jsx)(t.code,{children:"Find"})]}),"\n",(0,r.jsx)(t.li,{children:"If the CDC process worked correctly, you should see three book documents being returned"}),"\n"]}),(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Screenshot of MongoDB Compass",src:n(320).Z+"",width:"2320",height:"1428"})})]})]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsx)(t.p,{children:"If you are taking part in an instructor led lab, modify the query to include the unique combination of characters you added to the book IDs when adding them to Postgres."})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["Note the documents added to MongoDB with a continuous migration will include some of the fields we exluded when editing the mapping rules - specifically ID fields defined in primary key / foreign key constraints in Postgres. Relational Migrator relies on these fields to be able to accurately identify documents in MongoDB when applying updates. Look at the entries in the ",(0,r.jsx)(t.code,{children:"genres"})," array in a book document as an example."]})}),"\n",(0,r.jsx)(t.p,{children:"Now try deleting the records we just added from Postgres:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"DELETE FROM library.author_book WHERE  author_id = 9999;\nDELETE FROM library.book_genre WHERE book_id LIKE '14472240%';\nDELETE FROM library.books WHERE id LIKE '14472240%';\nDELETE FROM library.authors WHERE id = 9999;\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["If you are taking part in an instructor led lab, modify the ",(0,r.jsx)(t.code,{children:"author_id"})," and ",(0,r.jsx)(t.code,{children:"book_id"})," values to match those you used when inserting the data."]})}),"\n",(0,r.jsxs)(t.p,{children:["Check for updates to the ",(0,r.jsx)(t.code,{children:"Total events seen"})," and ",(0,r.jsx)(t.code,{children:"Events in the last hour"})," counts in Relational Migrator."]}),"\n",(0,r.jsx)(t.p,{children:"Verify the books have been deleted in MongoDB:"}),"\n",(0,r.jsxs)(s.Z,{groupId:"MongoDB Interfaces Documents Removed",children:[(0,r.jsxs)(l.Z,{value:"Atlas UI",label:"Atlas UI",children:[(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["In the Atlas UI, run the same search against the books collection: ",(0,r.jsx)(t.code,{children:"{_id: /^14472240/}"})]}),"\n",(0,r.jsx)(t.li,{children:"If the CDC process worked correctly, the query should not find any matching books"}),"\n"]}),(0,r.jsx)(i.Z,{url:"http://cloud.mongodb.com",src:"/img/220-image-017.png",alt:"Screenshot of the Atlas UI"})]}),(0,r.jsxs)(l.Z,{value:"Compass",label:"Compass",children:[(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["In Compass, run the same search against the books collection: ",(0,r.jsx)(t.code,{children:"{_id: /^14472240/}"})]}),"\n",(0,r.jsx)(t.li,{children:"If the CDC process worked correctly, the query should not find any matching books"}),"\n"]}),(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Screenshot of MongoDB Compass",src:n(3681).Z+"",width:"2308",height:"1440"})})]})]}),"\n",(0,r.jsxs)(t.p,{children:["Click the ",(0,r.jsx)(t.code,{children:"Complete CDC"})," button on the the Relational Migrator Data Migration tab to end the CDC job."]}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["If you close your Relational Migrator browser tab without clicking ",(0,r.jsx)(t.code,{children:"Complete CDC"}),", the CDC migration will continue to run in the background. You can end the job by either ruturning to the Relational Migrator UI, opening the project and clicking ",(0,r.jsx)(t.code,{children:"Complete CDC"})," on the data migration tab, or by exiting Relational Migrator."]})})]})}function g(e={}){let{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},320:function(e,t,n){n.d(t,{Z:function(){return o}});let o=n.p+"assets/images/220-image-014-0f9ffc9b797e040d3cdf9de43ea5d2d9.png"},3681:function(e,t,n){n.d(t,{Z:function(){return o}});let o=n.p+"assets/images/220-image-015-47627875020cbf04f2e71c99fb6510c6.png"},7645:function(e,t,n){n.d(t,{Z:()=>a});var o=n("5893");n("7294");var r=n("4904");function a(e){let{children:t,hidden:n,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.Z)("tabItem_Ymn6",a),hidden:n,children:t})}},8168:function(e,t,n){n.d(t,{Z:()=>x});var o=n("5893"),r=n("7294"),a=n("4904"),i=n("4718"),s=n("6550"),l=n("8714"),c=n("9207"),d=n("9413"),u=n("4510");function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||r.isValidElement(e)&&function(e){let{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){let{value:t,tabValues:n}=e;return n.some(e=>e.value===t)}var g=n("6735");function p(e){let{className:t,block:n,selectedValue:r,selectValue:s,tabValues:l}=e,c=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),u=e=>{let t=e.currentTarget,n=l[c.indexOf(t)].value;n!==r&&(d(t),s(n))},h=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{let n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{let n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1]}}t?.focus()};return(0,o.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},t),children:l.map(e=>{let{value:t,label:n,attributes:i}=e;return(0,o.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>{c.push(e)},onKeyDown:h,onClick:u,...i,className:(0,a.Z)("tabs__item","tabItem_LNqP",i?.className,{"tabs__item--active":r===t}),children:n??t},t)})})}function f(e){let{lazy:t,children:n,selectedValue:i}=e,s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){let e=s.find(e=>e.props.value===i);return e?(0,r.cloneElement)(e,{className:(0,a.Z)("margin-top--md",e.props.className)}):null}return(0,o.jsx)("div",{className:"margin-top--md",children:s.map((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i}))})}function b(e){let t=function(e){let{defaultValue:t,queryString:n=!1,groupId:o}=e,a=function(e){let{values:t,children:n}=e;return(0,r.useMemo)(()=>{let e=t??h(n).map(e=>{let{props:{value:t,label:n,attributes:o,default:r}}=e;return{value:t,label:n,attributes:o,default:r}});return!function(e){let t=(0,d.lx)(e,(e,t)=>e.value===t.value);if(t.length>0)throw Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}(e),[i,g]=(0,r.useState)(()=>(function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}let o=n.find(e=>e.default)??n[0];if(!o)throw Error("Unexpected error: 0 tabValues");return o.value})({defaultValue:t,tabValues:a})),[p,f]=function(e){let{queryString:t=!1,groupId:n}=e,o=(0,s.k6)(),a=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c._X)(a),(0,r.useCallback)(e=>{if(!a)return;let t=new URLSearchParams(o.location.search);t.set(a,e),o.replace({...o.location,search:t.toString()})},[a,o])]}({queryString:n,groupId:o}),[b,x]=function(e){let{groupId:t}=e,n=t?`docusaurus.tab.${t}`:null,[o,a]=(0,u.Nk)(n);return[o,(0,r.useCallback)(e=>{n&&a.set(e)},[n,a])]}({groupId:o}),j=(()=>{let e=p??b;return m({value:e,tabValues:a})?e:null})();return(0,l.Z)(()=>{j&&g(j)},[j]),{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!m({value:e,tabValues:a}))throw Error(`Can't select invalid tab value=${e}`);g(e),f(e),x(e)},[f,x,a]),tabValues:a}}(e);return(0,o.jsxs)("div",{className:(0,a.Z)("tabs-container","tabList__CuJ"),children:[(0,o.jsx)(p,{...t,...e}),(0,o.jsx)(f,{...t,...e})]})}function x(e){let t=(0,g.Z)();return(0,o.jsx)(b,{...e,children:h(e.children)},String(t))}},600:function(e,t,n){n.d(t,{Z:()=>i});var o=n("5893");function r(e){let t=e.url||"http://localhost:3000";return(0,o.jsxs)("div",{className:"browser container",children:[(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"column left",children:[(0,o.jsx)("span",{className:"dot",style:{background:"#ED594A"}}),(0,o.jsx)("span",{className:"dot",style:{background:"#FDD800"}}),(0,o.jsx)("span",{className:"dot",style:{background:"#5AC05A"}})]}),(0,o.jsx)("div",{className:"column middle",children:(0,o.jsx)("input",{type:"text",value:t})}),(0,o.jsx)("div",{className:"column right",children:(0,o.jsxs)("div",{style:{float:"right"},children:[(0,o.jsx)("span",{className:"bar"}),(0,o.jsx)("span",{className:"bar"}),(0,o.jsx)("span",{className:"bar"})]})})]}),(0,o.jsx)("div",{className:"content",children:e.children})]})}n("7294");var a=n("3187");function i(e){return(0,o.jsx)(r,{...e,children:(0,o.jsx)("img",{src:(0,a.ZP)(e.src),alt:e.alt})})}},65:function(e,t,n){n.d(t,{Z:function(){return s},a:function(){return i}});var o=n(7294);let r={},a=o.createContext(r);function i(e){let t=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(a.Provider,{value:t},e.children)}}}]);